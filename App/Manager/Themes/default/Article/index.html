<include file="Public/header"/><!--/HEADER -->

<!-- PAGE -->
<section id="page">
    <!-- SIDEBAR -->
    <include file="Public/menu"/>
    <!-- /SIDEBAR -->
    <div id="main-content">
        <!-- SAMPLE BOX CONFIGURATION MODAL FORM-->
        <div class="modal fade" id="box-config" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Box Settings</h4>
                    </div>
                    <div class="modal-body">
                        Here goes box setting content.
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
        <!-- /SAMPLE BOX CONFIGURATION MODAL FORM-->
        <div class="container">
            <div class="row">
                <div id="content" class="col-lg-12">
                    <!-- PAGE HEADER-->
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="page-header">
                                <!-- STYLER -->

                                <!-- /STYLER -->
                                <!-- BREADCRUMBS -->
                                <ul class="breadcrumb">
                                    <li>
                                <i class="icon-home home-icon"></i>
                                <a href="{:U('Index/index')}">首页</a>
                            </li>

                            <li>
                                <a href="#">文章管理</a>
                            </li>
                            <li class="active">文章列表</li>
                                </ul>
                                <div class="clearfix" style="margin-bottom:-10px;">
                                    <form action="" method="get" class="form-horizontal">

                                            <div class="col-sm-3 form-group">
                                                <label class="col-sm-3 control-label">分类：</label>
                                             <div class="form-group col-sm-8" >
                                                <select class="form-control"  name="cate" id="cate">
                                                    <option value="0">请选择分类</option>
                                                        <volist name="cate" id="v">
                                                            <option value="{$v.id}"<if condition="$Think.get.cate eq $v['id']">selected=selected </if>>{$v.cat_name}</option>
                                                            
                                                        </volist>
                                                </select>
                                             </div>
                                            </div>
                                            <div class=" form-group col-sm-3 " >
                                                <label class="control-label col-sm-4 ">发布人：</label>
                                                <div class="form-group col-sm-8" >
                                                    <select class="form-control"  name="uid" id="uid">
                                                        <option value="0">请选择发布人</option>
                                                        <volist name="list" id="v">
                                                            <option value="{$v.id}"<if condition="$Think.get.uid eq $v['id']"> selected=selected </if> >{$v.username}</option>
                                                            </volist>
                                                    </select>
                                                </div>
                                            </div>
                                            
                                            
                                            <div class="form-group col-sm-3" >
                                                <label class="control-label col-sm-4 "
                                                       >文章标题：</label>
                                                <div class="form-group col-sm-8" >
                                                    <span class="input-icon input-icon-right">
                                                        <input type="text" class="form-control"  placeholder="文章标题" name="title"
                                                                value="{$Think.get.title}">
                                                        </span>
                                                </div>
                                            </div>
                                          
                                            <div class="form-group col-sm-3" >
                                                <div class="col-sm-offset-1 col-sm-10">
                                                    <button class="btn btn-primary" type="submit">搜索</button>
                                                </div>
                                            </div>
                                             <a href="{:U('Article/add')}" class="btn btn-primary pull-right">添加文章 <i class="fa fa-arrow-right"></i></a>
                                       
                                    </form>

                                </div>

                                <!-- /BREADCRUMBS -->

                            </div>
                        </div>
                    </div>
                    <!-- /PAGE HEADER -->
                    <!-- SIMPLE STRIPED -->
                    <div class="row">

                        <div class="col-md-12">
                            <!-- BOX -->
                            <div class="box border primary">
                                <div class="box-title">
                                    <h4><i class="fa fa-table"></i>文章列表</h4>

                                    <div class="tools">

                                        <a href="javascript:;" class="collapse"> <i class="fa fa-chevron-up"></i> </a>

                                    </div>
                                </div>
                                <div class="box-body">
                                    <table class="table table-striped">
                                        <thead>
                                       <tr>         
                                            <th>ID</th>
                                            <th>文章标题</th>
                                            <th class="hidden-480">分类</th>
                                            <th>发布人</th>
                                            <th>排序</th>
                                            <th class="hidden-480">创建时间</th>
                                            <th class="hidden-480">更新时间</th>
                                            <th>操作</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <volist name="data.list" id="v">
                                           <tr>
                                            <td>{$v.article_id}</td>
                                            <td>{$v.title}</td>
                                            <td>{$v.cate_name}</td>
                                            <td>{$v.userName}</td>
                                            <td class="hidden-480"><span class="badge badge-purple">{$v.sort}</span> </td>
                                            <td class="hidden-480">{$v.create_time}</td>
                                             <td class="hidden-480">{$v.update_time}</td>
                                            <td>
                                                <a href="{:U('Article/edit',array('id'=>$v['article_id']))}" class="fa fa-pencil tip"data-original-title="修改"></a>
                                                <a href="javascript:void(0);"class="fa fa fa-trash-o tip tip article" data-original-title="删除"></a>
                                            </td>
                                        </tr>
                                        </volist>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="col-sm-6 pull-right">
                                    <div class="dataTables_paginate paging_bootstrap ">
                                        <ul class="pagination ">
                                            {$data.page}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <!-- /BOX -->
                        </div>
                    </div>
                    <!-- SIMPLE STRIPED -->

                    <!-- /BORDERED HOVER -->
                </div>
                <include file="Public/footer"/>
                  <script type="text/javascript">
                    $(".article").click(function(){
                        var id=$(this).parent().parent().find("td:eq(0)").html();
                        layer.confirm("你确定要删除吗？", {
                            btn: ['确定','取消'] //按钮
                        }, function(){
                            $.ajax({
                                url: "{:U('Article/del')}",
                                type: "POST",
                                data :{ "id":id },
                                dataType: "json",
                                success:function(response){
                                    if(response.error==100) {
                                        throwExc(response.message);
                                        return false;
                                    }else if(response.error==200) {
                                        showSucc(response.message);
                                        setTimeout("load()",1000);
                                    }else {
                                        throwExc(response.info);
                                        return false;
                                    }
                                },
                                error:function(response){
                                    throwExc(response.responseText);
                                    return false;
                                }
                            })
                        }, function(){
                            layer.msg('取消操作', {
                                time: 800, //20s后自动关闭
                            });
                        });
                     
                    });

                    function load(){
                        window.location.reload();
                    }
                </script>